<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="_fragments/layout :: layout(~{::section}, '주문 상세')">
<meta charset="UTF-8">
<section th:fragment="content" th:object="${order}">
  <h1>주문 상세 <small th:text="*{id}"></small></h1>

  <h2>주문자 정보</h2>
  <dl>
    <dt>회원</dt><dd th:text="*{memberId}">-</dd>
    <dt>주문일</dt><dd th:text="${#temporals.format(order.createdAt, 'yyyy-MM-dd HH:mm')}">-</dd>
    <dt>상태</dt><dd th:text="*{status}">PENDING</dd>
  </dl>

  <h2>배송지</h2>
  <div th:text="${shipment?.address}">-</div>

  <h2>결제정보</h2>
  <dl>
    <dt>수단</dt><dd th:text="${payment?.method}">-</dd>
    <dt>상태</dt><dd th:text="${payment?.status}">-</dd>
    <dt>금액</dt><dd th:text="${#numbers.formatInteger(payment?.amount, 3, 'COMMA')}">0</dd>
  </dl>

  <h2>주문상품</h2>
  <table>
    <thead>
    <tr>
      <th>상품</th>
      <th>수량</th>
      <th>단가</th>
      <th>소계</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="i : ${orderItems}">
      <td th:text="${i.productName}">-</td>
      <td th:text="${i.quantity}">1</td>
      <td th:text="${#numbers.formatInteger(i.unitPrice, 3, 'COMMA')}">0</td>
      <td th:text="${#numbers.formatInteger(i.subtotal, 3, 'COMMA')}">0</td>
    </tr>
    </tbody>
  </table>

  <h3>상태 변경</h3>
  <form th:action="@{|/admin/orders/${order.id}/status|}" method="post">
    <select name="status">
      <option>PENDING</option>
      <option>PAID</option>
      <option>SHIPPED</option>
      <option>CANCELLED</option>
      <option>REFUNDED</option>
    </select>
    <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    <button type="submit">저장</button>
  </form>

  <div style="margin-top:12px;">
    <a th:href="@{/admin/orders}">목록</a>
  </div>
</section>
</html>
